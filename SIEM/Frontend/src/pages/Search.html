<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SIEM Search</title>
  <style>
    body { background:#1e1e2f; color:#fff; font-family: Arial, sans-serif; margin:0; }
    header { background:#111; padding:10px 20px; color:#4fc3f7; }
    .container { padding:20px; }
    input, button { padding:10px; margin:5px; border-radius:5px; border:none; }
    input { width:300px; }
    button { background:#4fc3f7; color:#000; cursor:pointer; }
    table { width:100%; border-collapse: collapse; margin-top:20px; }
    th, td { padding:8px 12px; border-bottom:1px solid #444; text-align:left; }
    th { background:#333; }
  </style>
</head>
<body>
  <header>
    <h1>Search Logs</h1>
    <nav style="background:#222; padding:10px; display:flex; gap:15px;">
  <a href="dashboard.html" style="color:#fff; text-decoration:none;">Dashboard</a>
  <a href="alerts.html" style="color:#fff; text-decoration:none;">Alerts</a>
  <a href="search.html" style="color:#fff; text-decoration:none;">Search</a>
  <a href="incidents.html" style="color:#fff; text-decoration:none;">Incidents</a>
  <a href="reports.html" style="color:#fff; text-decoration:none;">Reports</a>
  <a href="settings.html" style="color:#fff; text-decoration:none;">Settings</a>
</nav>

  </header>
  <div class="container">
    <input id="query" type="text" placeholder="e.g. source.ip:192.168.1.10" />
    <button onclick="searchLogs()">Search</button>
    <table>
      <thead>
        <tr><th>@timestamp</th><th>Action</th><th>Source IP</th><th>User</th></tr>
      </thead>
      <tbody id="results"><tr><td colspan="4">No results</td></tr></tbody>
    </table>
  </div>

  <script>
    async function searchLogs() {
      const q = document.getElementById('query').value;
      const res = await fetch('/api/logs?level=1&q='+encodeURIComponent(q));
      const data = await res.json();
      const logs = data.logs || [];
      const tbody = document.getElementById('results');
      tbody.innerHTML = '';
      logs.forEach(l => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${l["@timestamp"]}</td><td>${l["event.action"]||''}</td><td>${l["source.ip"]||''}</td><td>${l["user.name"]||''}</td>`;
        tbody.appendChild(tr);
      });
    }
  </script>
</body>
</html>
